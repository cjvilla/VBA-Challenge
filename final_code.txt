Sub calcFinance() For Each Worksheet In ActiveWorkbook.Worksheets    Worksheet.Activate 'choosing all worksheets'        'headers'    Cells(1, "I").Value = "Ticker"    Cells(1, "J").Value = "Yearly_Change"    Cells(1, "K").Value = "Percent_Change"    Cells(1, "L").Value = "Stock_Volume"        'defined variables'    Dim ticker_name As String    Dim open_price As Double    Dim close_price As Double    Dim yearly_change As Double    Dim stock_volume As Double    Dim Stock As Double         'initialize table'    Row = 2 'data starts on row 2'    Column = 1 'start count at A'    last_row = Worksheet.Cells(Rows.Count, 1).End(xlUp).Row    final_last_row = Worksheet.Cells(Rows.Count, Column + 8).End(xlUp).Row    open_price = Cells(2, 2 + Column).Value        'headers'    Columns("H").Interior.ColorIndex = 48 'unused column. Blocked off w/ grey'    Cells(1, "I").Value = "Ticker"    Cells(1, "J").Value = "Yearly_Change"    Cells(1, "K").Value = "Percent_Change"    Cells(1, "L").Value = "Stock_Volume"           For i = 2 To last_row 'range for rows'            If (Cells(i + 1, Column).Value <> Cells(i, Column)) Then                ticker_name = Cells(i, Column).Value                Cells(Row, 8 + Column) = ticker_name                 'calc Close Price'                close_price = Cells(i, Column + 5).Value                'calc yearly change'                yearly_change = close_price - open_price                Cells(Row, 9 + Column).Value = yearly_change                                'calc percent change'                If (open_price = 0 And close_price <> 0) Then                    percent_change = 1                ElseIf (open_price = 0 And close_price = 0) Then                    percent_change = 0                Else                    percent_change = yearly_change / open_price                    Cells(Row, Column + 10).Value = percent_change                    'convert to percentage'                    Cells(Row, Column + 10).Value = Format(percent_change, "#.##%")                End If                               'calc stock volume'                Stock = Cells(i, Column + 6).Value + Stock                Cells(Row, Column + 11).Value = Stock                'row += 1'                Row = Row + 1                'clear data'                open_price = Cells(i + 1, Column + 2)                'clear data back to the beginning'                Stock = 0            Else                Stock = Stock + Cells(i, Column + 6).Value            End If            Next i                        'color coding'            For j = 2 To final_last_row               'red means negative'                If (Cells(j, Column + 9).Value > 0 Or Cells(j, Column + 9).Value = 0) Then                    Cells(j, Column + 9).Interior.ColorIndex = 10                'green means positive'                ElseIf Cells(j, Column + 9).Value < 0 Then                    Cells(j, Column + 9).Interior.ColorIndex = 3                End If                Next j                            Next Worksheet        End Sub        